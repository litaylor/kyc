<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,900,900i" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjiu-96EDVJ8T0Qpv8iayY028Sm7fO02g&libraries=places"></script>
    <style media="screen">
      /* STANDARD CSS */
      #article-content {
        max-width: 700px;
        margin: 0 auto;
        font-family: "Georgia";
      }
      #article-content h1 {
        font-family: "Muli", "Arial";
        font-size: 20px;
        line-height: 30px;
        font-weight: 900;
        padding: 7.5px;
        letter-spacing: 1px;
        background-color: black;
        color: white;
        margin: 120px 0 0;
        text-transform: uppercase;
      }
      #article-content h2 {
        font-family: "Muli", "Arial";
        font-size: 30px;
        font-weight: 900;
      }
      #article-content h3 {
        font-family: "Muli", "Arial";
        font-size: 18px;
        font-weight: 900;
        margin: 0;
        line-height: 30px;
      }
      p {
        font-size: 16px;
        line-height: 22.5px;
      }
      #article-content .kyc-can_card ul li p {
        font-size: 14px;
        line-height: 18.75px;
        margin-top: 0;
        margin-bottom: 0;
        font-family: Muli, Arial;
        white-space: pre-line;
      }
      @media (min-width:480px) {
        p {
          font-size: 18px;
        }
        #article-content .kyc-can_card ul li p {
          /* font-size: 18px;
          line-height: 30px; */
          font-size: 14px;
          line-height: 22.5px;
        }
      }
      @media (min-width:1200px) {
        p {
          font-size: 20px;
        }
        #article-content .kyc-can_card ul li p {
          /* font-size: 18px;
          line-height: 30px; */
          font-size: 14px;
          line-height: 22.5px;
        }
      }

      .kyc-container {
        margin-bottom: 120px;
      }
      .scroll .step {
        /* min-height: 100px; */
      }
      .kyc-ticker {
        height: 60px;
        width: 100%;
        /* border-top: thick black solid; */
        position: fixed;
        left: 0;
        bottom: 0;
        background-color: #fafafa;
        font-family: 'Muli';
        z-index: 1100;
      }
      .kyc-progress {
        position: fixed;
        left:0;
        bottom:60px;
        height: 0;
        width: 0%;
        border-top: thick gray solid;
      }
      .kyc-ticker ul {
        list-style: none;
        margin: 0;
        width: 100%;
        padding: 0;
      }
      .kyc-ticker ul li {
        display: inline-block;
        float: left;
        width: 33.33333%;
        box-sizing: border-box;
        text-align: center;
        line-height: 60px;
        border-right: 0.5px solid lightgray;
        cursor: pointer;
      }
      li.kyc-category_active {
        background-color: black;
        color: #fafafa;
      }
      .kyc-can_card {
        width: 90%;
        height: 225px;
        overflow: hidden;
        box-sizing: border-box;
        display: inline-block;
        float: left;
        border: 2px solid;
        background: white;
      }
      .DNR .kyc-can_card {
        background: none;
      }
      .kyc-can_card li {
        height: 100%;
        overflow-y: scroll;
      }
      .kyc-question_wrap {
        z-index: 1000;
        background-color: #fafafa;
        /* padding-bottom: 5px; */
        /* height:90px; */
      }
      .kyc-can_card.kyc-question_card {
        height: 105px;
        border: none;
        border-bottom: thick solid lightgray;
        margin-bottom: 15px;
      }
      .kyc-can_card.kyc-question_card ul li {
        padding: 5px 15px;
      }
      .kyc-question_card p {
        font-family: Muli, Arial;
        font-style: italic;
      }
      .kyc-question_card p::before {
        content: 'QUESTION: ';
        font-weight: 900;
        /* display: block; */
      }
      .kyc-can_scroll {
        width: 5%;
        height: 225px;
        box-sizing: border-box;
        /* border-bottom: thick solid lightgray; */
        background-color: lightgray;
        display: inline-block;
        float: left;
        cursor: pointer;
        z-index: 900;
        line-height: 225px;
        text-align: center;
      }
      .kyc-can_scroll.kyc-question_scroll {
        height: 105px;
        line-height: 105px;
      }
      .kyc-can_scroll:hover {
        background-color: black;
        color: white;
      }
      .kyc-can_card ul, .kyc-header ul {
        list-style: none;
        margin: 0;
        padding: 0;
        height: 100%;
        width: 500%;
      }
      .kyc-can_card ul li, .kyc-header ul li {
        display: inline-block;
        float: left;
        box-sizing: border-box;
        padding: 15px;
      }
      .kyc-button, .kyc-category h1, .kyc-question_wrap .kyc-can_scroll, .kyc-question_wrap .kyc-can_card {
        box-shadow: 5px 5px black;
      }
      #article-content .kyc-container .kyc-can .kyc-can_description {
        margin: 0 0 15px;
        font-style: italic;
        line-height: 15px;
      }
      .kyc-header input, .kyc-header select, #kyc-search {
        opacity: 0.25;
        pointer-events: none;
      }
      .kyc-header .kyc-status_message {
        opacity: 1;
        pointer-events: auto;
      }
      .kyc-header {
        margin-bottom: -120px;
      }

    </style>
    <style media="screen">
      .kyc-block {
        border:none;
        /* border-width: 0 0 0 5px;
        padding-left: 15px;
        border-style: solid; */
      }
      .kyc-can_list {
        border-color: gray;
      }
      .kyc-rep, .kyc-rep .kyc-can_card {
        border-color: #D65858;
      }
      .kyc-dem, .kyc-dem .kyc-can_card {
        border-color: #3378A3;
      }
      .kyc-rep .kyc-can_name::after {
        content: ' (R)';
        color: #D65858;
        opacity: 0.5;
      }
      .kyc-dem .kyc-can_name::after {
        content: ' (D)';
        color: #3378A3;
        opacity: 0.5;
      }
      .kyc-npa, .kyc-npa .kyc-can_card {
        border-color: gray;
      }
      .kyc-can {
        width: 100%;
        display: inline-block;
        margin-bottom: 15px;
      }
      .kyc-office h1 {
        margin-top: 0;
        padding-top: 105px;
      }
      /* .kyc-office:first-of-type {
        margin-bottom: 400px;
      } */
      .kyc-mug_wrap {
        box-sizing: border-box;
        display: block;
        float: left;
        width: 10%;
        height: 90px;
        /* margin-right: 15px; */
      }
      .kyc-mug {
        border: thick solid gray;
        border-radius: 50%;
        position: relative;
        width: 100%;
        padding-bottom: 100%;
        background-size: cover;
      }
      .kyc-rep .kyc-mug {
        border-color: #D65858;
      }
      .kyc-dem .kyc-mug {
        border-color: #3378A3;
      }
      .kyc-mug::after{
        position: absolute;
        content: '';
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0.25;
        border-radius: 50%;
      }
      .kyc-rep .kyc-mug::after{
        /* background-color: #D65858; */
      }
      .kyc-dem .kyc-mug::after{
        /* background-color: #3378A3; */
      }
      .kyc-npa .kyc-mug::after{
        /* background-color: gray; */
      }
      .kyc-can_content {
        box-sizing: border-box;
        display: block;
        float: left;
        width: 90%;
        padding-left: 15px;
      }
      .kyc-party_break {
        height: 15px;
      }
      .kyc-header {
        width: 100%;
        /* padding-left: 20px; */
      }
      .kyc-header-content {
        background: white;
        max-width: 300px;
        margin: 0 auto;
        padding: 15px;
        border: 1px solid black;
      }

      .kyc-can.DNR .kyc-can_scroll{
        display: none;
      }
      .kyc-can.DNR .kyc-can_card {
        height: auto;
        border: none;
      }
      .kyc-can.DNR .kyc-can_card::after {
        content: 'Candidate did not respond.';
        color: gray;
        text-decoration: italic;
      }
      .kyc-can.DNR .kyc-can_card *{
        display: none;
      }
      .kyc-form-icon {
        width: 10%;
        cursor: pointer;
        text-align: center;
        box-sizing: border-box;
        display: inline;
        /* float:left; */
      }
      #kyc-input_place  {
        width: 90%;
        float:right;
        height: 30px;
        display: inline-block;
        box-sizing: border-box;
        line-height: 25px;
        padding: 2.5px 5px;
      }
      .kyc-dropdown, .kyc-form-select {
        width: 80%;
        box-sizing: border-box;
        margin: 0 10%;
      }
      @media (min-width:576px) {
        .kyc-header-left {
          width: 15%;
        }
        .kyc-header-right {
          width: 85%;
          padding-left: 15px;
        }
      }
      .kyc-cancel {
        color: lightgray;
      }
      .kyc-cancel.active {
        color: #D65858;
      }
      .kyc-status_message {
        font-style: italic;
        line-height: 30px;
        font-size: 15px;
        text-align: center;
        font-family: Muli;
        font-weight: bold;
      }
      .kyc-status_party_DEM {
        display: none;
        background-color: #3378A3;
        color: white;
        padding: 2.5px 5px;
        margin: 0 2.5px;
      }
      .kyc-status_party_REP {
        display: none;
        background-color: #D65858;
        color: white;
        padding: 2.5px 5px;
        margin: 0 2.5px;
      }
      .kyc-status_ballot {
        display: none;
        background-color: black;
        color: white;
        padding: 2.5px 5px;
        margin: 0 2.5px;
      }
      .kyc-ballot_locations p {
        text-align: left;
        font-weight: 400;
        font-family: monospace;
        font-style: normal;
        font-size: 80%;
        line-height: 1;
      }
      .kyc-address-wrap {
        line-height: 30px;
      }
      .kyc-gps-wrap {
        text-align: center;
        margin: 0 auto;
        padding-bottom: 10px;
      }
      .kyc-button {
        box-sizing: border-box;
        display: inline-block;
        /* float:left; */
        text-align: center;
        padding: 5px;
        background-color: #3378A3;
        color: white;
        font-family: Muli;
        font-weight: bold;
        cursor: pointer;
      }
      #kyc-gps {
        padding: 5px 10px;
      }
      #kyc-search {
        width: 100%;
      }
      .kyc-button:hover {
        background-color: #D65858;
      }

    </style>
  </head>
  <body style = "background-color: #fafafa;">
    <div id="article-content">

      <h1>Know your candidates</h1>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec dapibus mollis tristique. Sed vehicula tellus at consectetur tristique.</p>
      <p>Ut non orci suscipit, facilisis leo sed, sollicitudin augue. Nunc nec dolor magna. Morbi laoreet urna eget mi tempus, ac porta nunc luctus.</p>
      <p>Pellentesque molestie vitae eros fringilla suscipit. Mauris sollicitudin, libero nec feugiat viverra, tellus turpis malesuada orci, ac varius elit ligula eu nibh.</p>

      <div class="kyc-container scroll">
        <div class="kyc-header">
          <div class="kyc-header-content">
            <!-- Show only races in my party:
            <br/>
            <br /> -->
            <!-- <select class="kyc-form-select" name="kyc-party-select">
              <option value="all">All Parties</option>
              <option value="dem">Democrat</option>
              <option value="rep">Republican</option>
            </select>
            <br />
            <br /> -->
            Only show races for my address:
            <br/>
            <br />
            <div class="kyc-gps-wrap">
              <div id="kyc-gps" class="kyc-button">
                Use location <i class="fas fa-map-marker-alt"></i>
              </div>
              <br />
              <br />
              or
              <br />
            </div>
            <div class="kyc-address-wrap">
              <div class = "kyc-form-icon kyc-cancel kyc-address-icon"><i class="fas fa-times"></i></div>
              <input id="kyc-input_place" type="text"/ placeholder="Enter your address">
              <div class = "kyc-form-icon kyc-search-button kyc-address-icon">&nbsp;</div>
            </div>
            <br />
            <br />

            <div id="kyc-search" class="kyc-button">
              Search <i class="fas fa-search"></i>
            </div>

            <br />


            <br />
            <br />


            <div class="kyc-status_message">
              <div class="kyc-status_loading">
                Loading...
              </div>
              <div class="kyc-status_real" style="display: none;">
                Showing all<br />
                <span class="kyc-status_party kyc-status_party_DEM">Democratic</span> <span class="kyc-status_party kyc-status_party_REP">Republican</span> candidates<br />
                <span class ="kyc-status_ballot"> on my ballot</span>
                <p></p>
                <div class="kyc-ballot_locations"></div>
              </div>
            </div>
            <br />
            <br />
            Jump to race:
            <br />
            <br />
            <div class="kyc-index" style="width:100%;">
              <select class="kyc-dropdown" name="kyc-dropdown">
                <option class="kyc-jumpto" value="jumpto" disabled selected>Jump to race...</option>
              </select>
            </div>
          </div>
        </div>
        <br />

        <div class="kyc-progress">

        </div>
        <div class="kyc-ticker" data-progress="50%">
          <ul>

          </ul>
        </div>
      </div>


      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec dapibus mollis tristique. Sed vehicula tellus at consectetur tristique.</p>
      <p>Ut non orci suscipit, facilisis leo sed, sollicitudin augue. Nunc nec dolor magna. Morbi laoreet urna eget mi tempus, ac porta nunc luctus.</p>
      <p>Pellentesque molestie vitae eros fringilla suscipit. Mauris sollicitudin, libero nec feugiat viverra, tellus turpis malesuada orci, ac varius elit ligula eu nibh.</p>
      <p>Nulla dolor ex, pulvinar et magna non, consequat euismod diam.</p>

      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec dapibus mollis tristique. Sed vehicula tellus at consectetur tristique.</p>
      <p>Ut non orci suscipit, facilisis leo sed, sollicitudin augue. Nunc nec dolor magna. Morbi laoreet urna eget mi tempus, ac porta nunc luctus.</p>
      <p>Pellentesque molestie vitae eros fringilla suscipit. Mauris sollicitudin, libero nec feugiat viverra, tellus turpis malesuada orci, ac varius elit ligula eu nibh.</p>
      <p>Nulla dolor ex, pulvinar et magna non, consequat euismod diam.</p>


    </div>

    <script src='https://polyfill.io/v2/polyfill.min.js?features=IntersectionObserver'></script>
    <script src='https://unpkg.com/intersection-observer'></script>
    <script src='https://unpkg.com/scrollama'></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.12.0/d3.min.js"></script> -->

    <!-- JAVASCRIPT POLYFILLS -->
    <script type="text/javascript">
      // .includes
        // https://tc39.github.io/ecma262/#sec-array.prototype.includes
        if (!Array.prototype.includes) {
          Object.defineProperty(Array.prototype, 'includes', {
            value: function(searchElement, fromIndex) {

              if (this == null) {
                throw new TypeError('"this" is null or not defined');
              }

              // 1. Let O be ? ToObject(this value).
              var o = Object(this);

              // 2. Let len be ? ToLength(? Get(O, "length")).
              var len = o.length >>> 0;

              // 3. If len is 0, return false.
              if (len === 0) {
                return false;
              }

              // 4. Let n be ? ToInteger(fromIndex).
              //    (If fromIndex is undefined, this step produces the value 0.)
              var n = fromIndex | 0;

              // 5. If n ≥ 0, then
              //  a. Let k be n.
              // 6. Else n < 0,
              //  a. Let k be len + n.
              //  b. If k < 0, let k be 0.
              var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

              function sameValueZero(x, y) {
                return x === y || (typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y));
              }

              // 7. Repeat, while k < len
              while (k < len) {
                // a. Let elementK be the result of ? Get(O, ! ToString(k)).
                // b. If SameValueZero(searchElement, elementK) is true, return true.
                if (sameValueZero(o[k], searchElement)) {
                  return true;
                }
                // c. Increase k by 1.
                k++;
              }

              // 8. Return false
              return false;
            }
          });
        }
      // .find
        // https://tc39.github.io/ecma262/#sec-array.prototype.find
        if (!Array.prototype.find) {
          Object.defineProperty(Array.prototype, 'find', {
            value: function(predicate) {
             // 1. Let O be ? ToObject(this value).
              if (this == null) {
                throw new TypeError('"this" is null or not defined');
              }

              var o = Object(this);

              // 2. Let len be ? ToLength(? Get(O, "length")).
              var len = o.length >>> 0;

              // 3. If IsCallable(predicate) is false, throw a TypeError exception.
              if (typeof predicate !== 'function') {
                throw new TypeError('predicate must be a function');
              }

              // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.
              var thisArg = arguments[1];

              // 5. Let k be 0.
              var k = 0;

              // 6. Repeat, while k < len
              while (k < len) {
                // a. Let Pk be ! ToString(k).
                // b. Let kValue be ? Get(O, Pk).
                // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).
                // d. If testResult is true, return kValue.
                var kValue = o[k];
                if (predicate.call(thisArg, kValue, k, o)) {
                  return kValue;
                }
                // e. Increase k by 1.
                k++;
              }

              // 7. Return undefined.
              return undefined;
            },
            configurable: true,
            writable: true
          });
        }
    </script>
    <!-- SCROLLAMA INIT -->
    <script type="text/javascript">
      function scrollama_init() {

        // setup the instance, pass callback functions
        scroller
        .setup({
          step: '.step', // required - class name of trigger steps
          container: '.scroll',
          offset: 0,
          progress: false,
          threshold: 4
        })
        .onStepEnter(handleStepEnter)
        .onStepProgress(handleStepProgress)
        .onStepExit(handleStepExit);

        function handleStepEnter(response) {
          $('.step').css({
            'position': 'relative',
            'top': -1
          });
          $(response.element).css({
            'position': '-webkit-sticky',
            'position': 'sticky',
            'top': -1
          })

        }
        function handleStepProgress(response) {

        }
        function handleStepExit(response) {

        }

        $(window).trigger('resize');
        $('.kyc-category').each(function() {
          build_ticker($(this));
        });

        $('.kyc-ticker ul li').click(function() {
          category = $(this).attr('class').substring($(this).attr('class').indexOf('_')+1);
          var el = $('.kyc-container').find('[data-category="'+category+'"]');
          if (el.length) {
            $('html, body').animate({
              scrollTop: el.offset().top
            }, 500);
          }
        });
      }
    </script>

    <script type="text/javascript">

      var FILTER_BY = {
        'level': 'all',
        'party': 'all',
        'issue': 'all',
        'race': 'all'
      };

      function build_ticker(category) {
        $('.kyc-ticker ul').append('<li class="kyc-ticker_'+category.data('category')+'"">'+category.data('category')+'</li>')
      }

      function what_level(object, the_level) {
        return object.level === 'State'
      }

      function build_dropdown(name, data) {
        var dropdown_category = $('<optgroup />', {
          'text' : name,
          'label' : name,
          appendTo : $('.kyc-dropdown')
        });
        for (var race in data) {
          if (data.hasOwnProperty(race)) {
            var dropdown_entry = $('<option />', {
              'text' : race,
              'value' : race,
              'class': 'kyc-no-hide-address kyc-no-hide-party kyc-option-'+data[race]['KYC-QUESTION'][0].gsx$googledivision.$t.replace(/:/g,'_').replace(/\//g,'_'),
              appendTo : dropdown_category
            });
            for (var party in data[race]) {
              if (data[race].hasOwnProperty(party)) {
                dropdown_entry.addClass(party);
              }
            }

          }
        }

      }

      // instantiate the scrollama
      var scroller = scrollama();

      var data = {
        'Federal' : {},
        'State': {},
        'Local': {}
      };

      var card_width = 10;

      $(document).ready(function() {


        $.ajax({
          url: "https://spreadsheets.google.com/feeds/list/1ARIAEYqvQtM6n-QpVS-LQbkeBQhW5lsmLiLVAO_CG0s/1/public/full?alt\x3djson",
          type: "GET",
          cache: false,
          success: function(response) {

            response_data=response.feed.entry;

            for (var i = 0; i < response_data.length; i++) {

              candidate = response_data[i];

              if (!data[candidate.gsx$officelevel.$t][candidate.gsx$officefull.$t]) {
                data[candidate.gsx$officelevel.$t][candidate.gsx$officefull.$t] = {};
              }
              if (!data[candidate.gsx$officelevel.$t][candidate.gsx$officefull.$t][candidate.gsx$party.$t]) {
                data[candidate.gsx$officelevel.$t][candidate.gsx$officefull.$t][candidate.gsx$party.$t] = []
              }

              data[candidate.gsx$officelevel.$t][candidate.gsx$officefull.$t][candidate.gsx$party.$t].push(candidate);
            }


            for (var level in data) {

              build_dropdown(level, data[level])

              var kyc_category = $('<div />', {
                'class' : 'kyc-category',
                'data-category' : level,
                appendTo : $('.kyc-container')
              });

              for (var office in data[level]) {
                var kyc_office = $('<div />', {
                  'class' : 'kyc-office kyc-no-hide-address kyc-no-hide-party',
                  'data-office' : office,
                  html : '<h1>'+office+'</h1>',
                  appendTo : kyc_category
                });

                for (var party in data[level][office]) {
                  var kyc_party = $('<div />', {
                    'class' : 'kyc-block kyc-no-hide-address kyc-no-hide-party kyc-party kyc-'+party.toLowerCase(),
                    appendTo : kyc_office
                  });


                  for (var i = 0; i < data[level][office][party].length; i++) {

                    // TEST IF Q OR A
                    if (data[level][office][party][i].gsx$party.$t!== 'KYC-QUESTION') {
                      var kyc_can = $('<div />', {
                        'class': 'kyc-can kyc-div_'+data[level][office][party][i].gsx$googledivision.$t.replace(/:/g,'_').replace(/\//g,'_'),
                        appendTo : kyc_party
                      });
                      var kyc_mug_wrap = $('<div />', {
                        'class': 'kyc-mug_wrap',
                        appendTo : kyc_can
                      });
                      var kyc_mug = $('<div />', {
                        'class': 'kyc-mug',
                        'style': 'background-image: url("'+data[level][office][party][i].gsx$mugurl.$t+'");',
                        appendTo : kyc_mug_wrap
                      });
                      var kyc_can_content = $('<div />', {
                        'class': 'kyc-can_content',
                        appendTo : kyc_can
                      });
                      var kyc_can_name = $('<h3 />', {
                        'class': 'kyc-can_name',
                        text: data[level][office][party][i].gsx$namefirst.$t + ' ' + data[level][office][party][i].gsx$namelast.$t,
                        appendTo : kyc_can_content
                      });
                      var kyc_can_description = $('<p />', {
                        'class': 'kyc-can_description',
                        text: data[level][office][party][i].gsx$title.$t,
                        appendTo : kyc_can_content
                      });
                      var kyc_can_scrollLeft = $('<div />', {
                        'class': 'kyc-can_scroll kyc-can_scrollLeft',
                        html: '<i class="fas fa-arrow-left"></i>',
                        appendTo : kyc_can_content
                      });
                      var kyc_can_card = $('<div />', {
                        'class': 'kyc-can_card',
                        appendTo : kyc_can_content
                      });
                      var kyc_can_scrollRight = $('<div />', {
                        'class': 'kyc-can_scroll kyc-can_scrollRight',
                        html: '<i class="fas fa-arrow-right"></i>',
                        appendTo : kyc_can_content
                      });
                      var kyc_can_card_ul = $('<ul />', {
                        appendTo : kyc_can_card
                      });

                      var total_answers_length = 0;
                      for (var question in data[level][office][party][i]) {
                        if (data[level][office][party][i].hasOwnProperty(question)) {
                          if (question.indexOf('issue-')>=0) {
                            if (data[level][office][party][i][question].$t.length>0) {
                              var kyc_can_card_issueQ = $('<li />', {
                                appendTo : kyc_can_card_ul
                              });
                              var kyc_can_card_issueQ_p = $('<p />', {
                                text: data[level][office][party][i][question].$t,
                                appendTo : kyc_can_card_issueQ
                              });
                            }

                            total_answers_length += data[level][office][party][i][question].$t.length;


                          }
                        }
                      }
                      if (total_answers_length < 1) {
                        // CANDIDATE DID NOT RESPOND
                        kyc_can.addClass('DNR');
                      }
                    }
                    else {
                      // THIS IS A QUE CARD
                      var kyc_question_wrap = $('<div />', {
                        'class': 'kyc-question_wrap step',
                        appendTo : kyc_office
                      })
                      var kyc_can_scrollLeft = $('<div />', {
                        'class': 'kyc-can_scroll kyc-can_scrollLeft kyc-question_scroll',
                        html: '<i class="fas fa-arrow-left"></i>',
                        appendTo : kyc_question_wrap
                      });
                      var kyc_can_card = $('<div />', {
                        'class': 'kyc-can_card kyc-question_card',
                        appendTo : kyc_question_wrap
                      });
                      var kyc_can_scrollRight = $('<div />', {
                        'class': 'kyc-can_scroll kyc-can_scrollRight kyc-question_scroll',
                        html: '<i class="fas fa-arrow-right"></i>',
                        appendTo : kyc_question_wrap
                      });

                      var kyc_can_card_ul = $('<ul />', {
                        appendTo : kyc_can_card
                      });

                      for (var question in data[level][office][party][i]) {
                        if (data[level][office][party][i].hasOwnProperty(question)) {
                          if (question.indexOf('issue-')>=0) {
                            if (data[level][office][party][i][question].$t.length>0) {
                              var kyc_can_card_issueQ = $('<li />', {
                                appendTo : kyc_can_card_ul
                              });
                              var kyc_can_card_issueQ_p = $('<p />', {
                                text: data[level][office][party][i][question].$t,
                                appendTo : kyc_can_card_issueQ
                              });
                            }
                          }
                        }
                      }


                      $('.kyc-dem').parents('.kyc-office').addClass('kyc-office-dem');
                      $('.kyc-rep').parents('.kyc-office').addClass('kyc-office-rep');
                      $('.kyc-npa').parents('.kyc-office').addClass('kyc-office-npa');
                    }

                  }
                }
              }
              scroller.resize();
              }
            scrollama_init();
            $('.kyc-header *').css({
              'opacity': 1,
              'pointer-events': 'auto'
            })
            $('.kyc-status_loading').hide();
            $('.kyc-status_real').fadeIn('fast');
          }
        })
      })

      $(window).resize(function() {

        if (scroller) {
          scroller.resize();
        }

        $('.kyc-can_card').each(function() {
          entries = $(this).find('ul').children().length;

          $(this).find('ul').css('width', (entries*100)+'%');
          $(this).find('ul li').css('width', (100/entries)+'%');


        })

      });

      function scrollList(scroll_element, multiplier) {
        question_card = scroll_element;
        questions_positions = [];
        question_card.find('ul > li').each(function() {
          questions_positions.push($(this).position().left);
        })
        questions_width = questions_positions[1]-questions_positions[0];

        // SCROLL PARENT DIV TO NEXT QUE LI
        scroll_value = question_card.scrollLeft() + (questions_width * multiplier);
        question_card.animate({
          scrollLeft: scroll_value
        }, 500);
      }
      $('body').on('click','.kyc-can_scrollRight', function() {
        scrollList($(this).parents('.kyc-office').find('.kyc-question_card'), 1);
        question_card.parents('.kyc-office').find('.kyc-can_card:not(.kyc-question_card)').each(function() {
          scrollList($(this), 1);
        });
      });
      $('body').on('click','.kyc-can_scrollLeft', function() {
        scrollList($(this).parents('.kyc-office').find('.kyc-question_card'), -1);
        question_card.parents('.kyc-office').find('.kyc-can_card:not(.kyc-question_card)').each(function() {
          scrollList($(this), -1);
        });
      });

      // FILTER BY PARTY
      $('.kyc-header select[name=kyc-party-select]').change(function() {
        fire_party_search($(this).val());
      });
      // JUMP TO RACE ON SELECT CHANGE
      $('.kyc-dropdown').change(function() {
        JUMP_TO = $(this).val();
        $([document.documentElement, document.body]).animate({
          scrollTop: $('[data-office="'+JUMP_TO+'"]').offset().top
        }, 1000);
      })

    </script>

    <script type="text/javascript">
      function filter_offices() {
        $('.kyc-status_loading').show();
        $('.kyc-status_real').hide();

        // SHOW EVERYTHING
        $('.kyc-office').show();
        $('.kyc-block').show();
        $('.kyc-dropdown option').each(function() {
          this.disabled = false;
        });

        $('.kyc-no-hide').removeClass('kyc-no-hide');

        $('.kyc-no-hide-address').parents('.kyc-office').addClass('kyc-no-hide-address');
        $('.kyc-no-hide-address').parents('.kyc-block').addClass('kyc-no-hide-address');
        $('.kyc-no-hide-address.kyc-office').addClass('kyc-no-hide-address');
        $('.kyc-no-hide-address.kyc-block').addClass('kyc-no-hide-address');

        $('.kyc-no-hide-party').parents('.kyc-office').addClass('kyc-no-hide-party');
        $('.kyc-no-hide-party').parents('.kyc-block').addClass('kyc-no-hide-party');
        $('.kyc-no-hide-party.kyc-office').addClass('kyc-no-hide-party');
        $('.kyc-no-hide-party.kyc-block').addClass('kyc-no-hide-party');

        // HIDE EVERYTHING EXCEPT NO-HIDES
        $('.kyc-office:not(.kyc-no-hide-address.kyc-no-hide-party)').hide();
        $('.kyc-block:not(.kyc-no-hide-address.kyc-no-hide-party)').hide();

        // DISABLE ALL OPTIONS EXCEPT NO-HIDES
        $('.kyc-dropdown option:not(.kyc-no-hide-address.kyc-no-hide-party)').each(function() {
          this.disabled = true;
        });

        $('.kyc-status_loading').hide();
        $('.kyc-status_real').fadeIn('fast');
      }
      function fire_gps() {
        console.log(navigator);
        // From Google Maps Platform guide
        if (navigator.geolocation.getCurrentPosition) {
          console.log('yes');
          navigator.geolocation.getCurrentPosition(function(position) {
            var pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };
            if (pos) {
              console.log('pos');
              $('#kyc-input_place')[0].value = pos.lat + ', '+pos.lng;
              fire_address_search();
            }
            else {
              $('#kyc-input_place')[0].value = 'GPS error'
            }
          }, function(error) {
            console.log('poserror');
            $('#kyc-input_place')[0].value = 'GPS error'
          });
        } else {
          // Browser doesn't support Geolocation
          $('#kyc-input_place')[0].value = 'GPS error'
        }
      }

      function fire_address_search() {
        var address = $('#kyc-input_place')[0].value;
        $.get('https://www.googleapis.com/civicinfo/v2/representatives?key=AIzaSyBjiu-96EDVJ8T0Qpv8iayY028Sm7fO02g&address='+address, function(response) {
          $('.kyc-no-hide-address').removeClass('kyc-no-hide-address');
          console.log(response.divisions);
          $('.kyc-ballot_locations').html('');
          $('.kyc-ballot_locations').append('<p>Location:</p>')
          for (var division in response.divisions) {
            if (response.divisions.hasOwnProperty(division)) {
              division_slug = division.replace(/:/g,'_').replace(/\//g,'_');
              $('.kyc-div_'+division_slug).addClass('kyc-no-hide-address');
              $('.kyc-option-'+division_slug).addClass('kyc-no-hide-address');

              $('.kyc-ballot_locations').append('<p>'+response.divisions[division].name.toUpperCase()+'</p>')
            }
          }
          filter_offices();
          if (scroller) {
            scroller.resize();
          }
          $('.kyc-status_ballot').show();
        });
      }
      function fire_party_search(party) {
        FILTER_BY.party = party;

        $('.kyc-no-hide-party').removeClass('kyc-no-hide-party');
        $('.kyc-npa').addClass('kyc-no-hide-party');
        $('.kyc-dropdown option.NPA').addClass('kyc-no-hide-party');

        if (FILTER_BY.party!=='all') {
          $('.kyc-'+FILTER_BY.party).addClass('kyc-no-hide-party');
          $('.kyc-dropdown option.'+FILTER_BY.party.toUpperCase()).addClass('kyc-no-hide-party');
        }
        else {
          $('.kyc-block').addClass('kyc-no-hide-party');
          $('.kyc-dropdown option').addClass('kyc-no-hide-party');
        }

        filter_offices();

        if (scroller) {
          scroller.resize();
        }
        $('.kyc-status_party').hide();
        $('.kyc-status_party_'+FILTER_BY.party.toUpperCase()).show();
      }
      function initialize() {
        var input = document.getElementById('kyc-input_place');
        var autocomplete = new google.maps.places.Autocomplete(input);
        var circle = new google.maps.Circle({
          center: {
            lat: 27.960312,
            lng: -82.452927
          },
          radius: 300
        });
        autocomplete.setBounds(circle.getBounds());

        $('#kyc-input_place').keypress(function(e) {
          if (e.which == 13) {
            fire_address_search();
          }
        });

        $('#kyc-gps').click(function() {
          fire_gps();
        });
        $('#kyc-search').click(function() {
          fire_address_search();
        });
        $('#kyc-input_place').change(function() {
          if (this.value.length>0) {
            $('.kyc-cancel').addClass('active');
          }
          else {
            $('.kyc-cancel').removeClass('active');
          }
        })
        $('.kyc-cancel').click(function() {
          $('#kyc-input_place').val('');
          $('.kyc-status_ballot').hide()
          $('.kyc-block, .kyc-office').addClass('kyc-no-hide-address');
          filter_offices();
          $('.kyc-ballot_locations').html('');
        });

      }

      $('body').on('click', '.pac-container, .pac-item', function () {
        alert('clack');
      });
      $('.pac-container, .pac-container *').click(function(){
        fire_address_search();
      });

      $(document).ready(function() {initialize(); });

    </script>

  </body>
</html>
